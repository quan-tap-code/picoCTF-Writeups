# IntroToBurp
Challenge link: https://play.picoctf.org/practice/challenge/419
- [Solution](#solution)
- [Documentation](#documentation)
## Solution
Start instance on the challenge page to get access to the website. We got to this website.

There is a `Registration` form like. Let's try random information and hit `Register`.

![image](https://github.com/user-attachments/assets/812b9d57-e287-45bf-8229-84037072f9d4)

We continue to this website after enterning random information. Let's enter a random value again and hit `Submit`.

![image](https://github.com/user-attachments/assets/5291bb05-5e44-44d4-9a0e-ca6a4c40c421)

We get a `Invalid OTP` message. There nothing we can't do more including inspecting the website.

![image](https://github.com/user-attachments/assets/5b6686da-3455-45d3-a690-ba636809d55d)


It's time to read the hint !

`Try using burpsuite to intercept request to capture the flag.`

`Try mangling the request, maybe their server-side code doesn't handle malformed requests very well.`

They ask us to use burpsuite to intercept the request to the flag. 

Open [burpsuite](https://portswigger.net/burp) and start a browser in `burpsuite`. If you using `kali-linux`, burpsuite is pre-installed. Other distro can install it using it website to download the installer.

We will try to intercept the `/dashboard` page. After enter random information and click `Register`. Under the `Proxy` tab in `burpsuite` turn on the intercepter.

Enter a random OTP and click `Submit`. In `burpsuite` we could see the request.
```
POST /dashboard HTTP/1.1
Host: titan.picoctf.net:50552
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:126.0) Gecko/20100101 Firefox/126.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Referer: http://titan.picoctf.net:59762/dashboard
Content-Type: application/x-www-form-urlencoded
Content-Length: 9
Origin: http://titan.picoctf.net:59762
DNT: 1
Connection: keep-alive
Cookie: session=.eJwti8sOwiAQAP9lzx6EQhe9afU7CI8lGltooMQY47-7Jt5mJpk3hPv2giNcYAeh1WS38qDMQVDUygdlkkEjCdGPWjr0pP2AQwwqBilHceAv9Xm22S3E24m9bCsTCmlwz7q61p6lRm7Xn95KJpv74qlymjj1RvX_n-HzBaDgK5c.Zmb6Dw.kY8tuOGUScAGpfmmCA7JVYn5T6E
Upgrade-Insecure-Requests: 1
Priority: u=1

otp=1
```
We could see the `otp` value is the `OTP` we just entered. We could change the value to anything else to request something else like `a=1234` or delete the `otp` part to get access. 

We would get this reply.

```
Welcome, B you sucessfully bypassed the OTP request. 
Your Flag: picoCTF{SPOILER}
```
## Documentation
[Burp Suite - Homepage](https://portswigger.net/burp)

[Wikipedia - HTTP](https://en.wikipedia.org/wiki/HTTP)

[Wikipedia - Multi-factor authentication](https://en.wikipedia.org/wiki/Multi-factor_authentication)

[Wikipedia - One-time password](https://en.wikipedia.org/wiki/One-time_password)
